= content_for :title, "Top Searches - "
= affiliate_center_breadcrumbs([ link_to(@affiliate.display_name, affiliate_path(@affiliate)), 'Top Searches'] ) if @affiliate
- form_path = @affiliate ? affiliate_top_searches_path(@affiliate) : admin_top_searches_path
- widget_url = @affiliate ? trending_searches_widget_url(:aid => @affiliate.id) : trending_searches_widget_url
%h2
  Top Searches
= form_tag form_path, :method => :post do
  - if @affiliate
    = label_tag 'top_searches_label', 'Label'
    = text_field_tag 'top_searches_label', @affiliate.top_searches_label
  %table
    %tr
      %th
        Position
      %th
        Term
      %th
        URL
    - 0.upto(4).each do |index|
      %tr
        %td
          Term ##{index + 1}:
        %td
          = label_tag "query#{index + 1}", nil, :style => "display: none;"
          = text_field_tag "query#{index + 1}", @top_searches[index] ? @top_searches[index].query : ""
        %td
          = label_tag "url#{index + 1}", nil, :style => "display: none;"
          = text_field_tag "url#{index + 1}", @top_searches[index] ? @top_searches[index].url : ""
  = submit_tag 'Update Widget'

%br
%h2
  Preview Widget
= render_trending_searches

%br{:style => 'clear: both;'}
%h2
  Widget Code
%p
  Copy and paste the following snippet onto any page you want to display the Top Searches on your website:
%p
  %textarea{ :readonly => true }
    :escaped
      <iframe width="650" scrolling="no" height="30" frameborder="0" src="#{widget_url}"></iframe>