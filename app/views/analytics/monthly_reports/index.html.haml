#h1
  Monthly Usage

- form_tag(monthly_reports_path, :method => :get) do
  = select_date @report_date, { :discard_day => true, :start_year => 2010, :end_year => @today.year }
  = submit_tag 'Get Usage Stats'
%br
- if @report_date.future?
  %p
    Report information not available for the future.
- else
  .span-14
    %h3
      = "Monthly Usage Stats for #{Date::MONTHNAMES[@report_date.month.to_i]} #{@report_date.year}"
      - unless @report_date.year != @today.year || @report_date.month != @today.month
        = "(current as of #{Date::MONTHNAMES[@today.yesterday.month.to_i]} #{@today.yesterday.day}, #{@today.yesterday.year})"
    - DailyUsageStat::PROFILE_NAMES.each do |profile_name|
      .usage_stats{ :id => "#{profile_name.downcase}_usage_stats" }
        Profile: #{profile_name}
        %ul
          %li
            Total Queries: #{number_with_delimiter @monthly_totals[profile_name][:total_queries]}
          %li
            Total Page Views: #{number_with_delimiter @monthly_totals[profile_name][:total_page_views]}
          %li
            Total Unique Visitors: #{number_with_delimiter @monthly_totals[profile_name][:total_unique_visitors]}
    %p
      = analytics_monthly_report_link(@report_date)
  - if @clicks.present?
    .span-6
      %h3 Clicks by module
      %table{:id => "module_click_stats"}
        %tr
          %th Module
          %th Clicks
        - @clicks.each_pair do |module_name, click_count|
          %tr
            %td=module_name
            %td=click_count