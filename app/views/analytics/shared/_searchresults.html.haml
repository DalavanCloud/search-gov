:javascript
  function selectAllQueries() {
    var queriesForm = document.forms['queries'];
    for (var i = 0; i < queriesForm.length; i++) {
      queriesForm.elements[i].checked = "checked";
    }
  }
%div= flash[:notice] if flash[:notice]
- if (@search_results.size > 0)
  %p= "Matches for '#{h @search_query_term}'"
  - form_tag bulk_add_analytics_query_groups_path, :method => :post, :name => 'queries' do
    %table
      %tr
        %th Query term
        %th{:style=>"text-align: right;"} Frequency
        %th{:style => "text-align: center;"}
          = "Add to Query Group"
          %br
          = "(#{ link_to 'Select All', 'javascript:selectAllQueries();'})"
      - @search_results.each_pair do |query, count|
        %tr
          %td
            = link_to_unless(affiliate.present?, query, query_timeline_path(query))
            = link_to_unless(affiliate.present?, image_tag("open_new_window.png", :alt => "Open graph in new window", :size => "8x8"),    query_timeline_path(query), :popup=>['_blank', 'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,height=450,width=1000'], :title => "Open graph in new window") 
          %td{:style=>"text-align: right;"}= count
          %td{:style => "text-align: center;"}
            = check_box_tag("bulk_add_#{query.parameterize}", query)
      %tr
        %td
        %td
        %td{:style => "text-align: center;"}
          = select 'query_group', 'name', options_from_collection_for_select(QueryGroup.all, 'name', 'name'), { :include_blank => true }
          = submit_tag 'Add to Query Group'

- elsif (@search_query_term.blank?)
  %p.noresults= "Please enter search term(s)"
- else
  %p.noresults= "Sorry, no results found for '#{h @search_query_term}'."