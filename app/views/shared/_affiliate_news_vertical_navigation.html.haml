- rss_feed = @search.is_a?(NewsSearch) ? @search.rss_feed : nil
- search_params = {:query => params[:query], :locale => params[:locale], :affiliate => @affiliate.name}
- search_params.merge!(:channel => rss_feed.id) if rss_feed
- search_params.merge!(:tbs => params[:tbs]) if params[:tbs]
%br
  = link_to_if(rss_feed, "Everything", params[:tbs] ? news_search_path(search_params.remove(:channel)) : search_path(search_params.remove(:channel))) do |everything|
    = content_tag :span, everything
- @affiliate.active_rss_feeds.each do |feed|
  %br
    = link_to_unless((rss_feed && rss_feed.id == feed.id), feed.name, news_search_path(search_params.merge(:channel => feed.id))) do |channel_name|
      = content_tag :span, channel_name

%br
%br
  = link_to_if(params[:tbs], "All Time", rss_feed ? news_search_path(search_params.remove(:tbs)) : search_path(search_params.remove(:tbs))) do |everything|
    = content_tag :span, everything
- NewsItem::TIME_BASED_SEARCH_OPTIONS.each_pair do |tbs, extent|
  %br
    = link_to_unless((params[:tbs] == tbs), "Last #{extent}", news_search_path(search_params.merge(:tbs => tbs))) do |last_time|
      = content_tag :span, last_time
